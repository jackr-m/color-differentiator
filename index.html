<!doctype html>

<html lang="en">
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script>
    let left_lighter = false;
    let correct_guesses = 0;
    let total_guesses = 0;
    let win_streak = 0;
    let previous_correct = false;
    function getRandomColor() {
      let  characters = '123456789ABCDEF';
      let color = '#';
      for (let i = 0; i < 6; i++) {
        color += characters.charAt(Math.floor(Math.random() * characters.length));
      }
      // console.log("Random color generated: " + color)
      total_guesses++;
      return color;
    }
    function getDimmerColor(original) {
      let color = parseInt(original.slice(1), 16);
      let subtract_value;
      let channel = Math.floor(Math.random() * 3);
      if (channel === 0) {
        subtract_value = 0x010000;
      } else if (channel === 1) {
        subtract_value = 0x000100;
      } else {
        subtract_value = 0x000001;
      }
      color -= subtract_value;
      color = color.toString(16).toUpperCase();
      color = '#' + color;
      // console.log("Dimmer color generated: " + color);
      return color;
    }
    function setColors() {
      let first_side = Math.floor(Math.random() * 2)
      let original_color = getRandomColor();
      let dimmer_color = getDimmerColor(original_color);
      if (first_side === 0) {
        $("#colorBox1").css("background-color", original_color);
        $("#colorBox2").css("background-color", dimmer_color);
        left_lighter = true;
        console.log("Left color: " + original_color)
        console.log("Right color: " + dimmer_color)
      }
      else {
        $("#colorBox2").css("background-color", original_color);
        $("#colorBox1").css("background-color", dimmer_color);
        left_lighter = false;
        console.log("Left color: " + dimmer_color)
        console.log("Right color: " + original_color)
      }
      // console.log("Left lighter? " + left_lighter);
    }
    function checkColors(left_lighter, guess) {
      // console.log("Left lighter? " + left_lighter)
      // console.log("Guess: " + guess)
      if (left_lighter === guess) {
        $("#colorBox1").css("background-color", "#00FF00");
        $("#colorBox2").css("background-color", "#00FF00");
        correct_guesses ++;
        if (previous_correct === true) {
          win_streak ++;
        }
        previous_correct = true;
        // console.log("Correct!")
      }
      else {
        $("#colorBox1").css("background-color", "#FF0000");
        $("#colorBox2").css("background-color", "#FF0000");
        previous_correct = false;
        win_streak = 0;
        // console.log("Incorrect!")
      }
      setTimeout(function() {
        setColors(left_lighter);
      }, 2000);
    }
    function updateText() {
      let percentage = (correct_guesses / total_guesses) * 100;
      $("#percentage").text(percentage.toFixed(0) + "%");
      $("#totalGuesses").text(total_guesses);
      $("#correctGuesses").text(correct_guesses);
      $("#winStreak").text(win_streak);
    }
  </script>
  <title></title>
  <!--  <style>-->
<!--    #colorBox{-->
<!--      font-size:100px;-->
<!--      text-align:center;-->
<!--      margin:50px auto;-->
<!--      font-family:Arial, sans-serif;-->
<!--    }-->
<!--  </style>-->
</head>
<body onload="setColors();" style="background-color:#aaaaaa">
<div id="container" style="width:90%; height:70vh; margin:auto;">
  <div id="colorBox1" style="width:40vw;height:90%;padding:10px;float:left;border-radius:20px;background-color:#000"></div>
  <div id="colorBox2" style="width:40vw;height:90%;padding:10px;float:right;border-radius:20px;background-color:#000"></div>
</div>
<div style="clear: both;"></div>
<div style="text-align:center;">
  <button style="width:10vh;height:6vh;font-size:2vmin" onclick="checkColors(left_lighter, true); updateText();">Left one is Lighter</button>
  <button style="width:10vh;height:6vh;font-size:2vmin" onclick="checkColors(left_lighter, false); updateText();">Left one is Darker</button>
  <br>
  <br>
  <br>
  <button style="width:10vh;height:6vh;font-size:2vmin" onclick="setColors(); updateText();">New Color Set</button>
  <br>
  <br>
  Win percentage: <span id="percentage"></span>
  <br>
  Total guesses: <span id="totalGuesses"></span>
  <br>
  Total correct: <span id="correctGuesses"></span>
  <br>
  Win streak: <span id="winStreak"></span>
</div>
</body>
</html>
